***************
*** 79,88 ****
  	 ** array( 'UnlistedSpecialPage', name, right )
  	 ** array( 'SpecialRedirectToSpecial', name, page to redirect to, special page param, ... )
  	 */
  	static public $mList = array(
! 		'DoubleRedirects'           => array( 'SpecialPage', 'DoubleRedirects' ),
! 		'BrokenRedirects'           => array( 'SpecialPage', 'BrokenRedirects' ),
! 		'Disambiguations'           => array( 'SpecialPage', 'Disambiguations' ),
  
  		'Userlogin'                 => array( 'SpecialPage', 'Userlogin' ),
  		'Userlogout'                => array( 'UnlistedSpecialPage', 'Userlogout' ),
--- 79,90 ----
  	 ** array( 'UnlistedSpecialPage', name, right )
  	 ** array( 'SpecialRedirectToSpecial', name, page to redirect to, special page param, ... )
  	 */
+ 	//AP20070718
+ //Add ", 'block'" to arrays for pages to restrict from general users (users w/o block permissions)
  	static public $mList = array(
! 		'DoubleRedirects'           => array( 'SpecialPage', 'DoubleRedirects', 'block' ),
! 		'BrokenRedirects'           => array( 'SpecialPage', 'BrokenRedirects', 'block' ),
! 		'Disambiguations'           => array( 'SpecialPage', 'Disambiguations', 'block' ),
  
  		'Userlogin'                 => array( 'SpecialPage', 'Userlogin' ),
  		'Userlogout'                => array( 'UnlistedSpecialPage', 'Userlogout' ),
***************
*** 92,129 ****
  
  		'Recentchanges'             => 'SpecialRecentchanges',
  		'Upload'                    => array( 'SpecialPage', 'Upload' ),
! 		'Imagelist'                 => array( 'SpecialPage', 'Imagelist' ),
  		'Newimages'                 => array( 'IncludableSpecialPage', 'Newimages' ),
! 		'Listusers'                 => array( 'SpecialPage', 'Listusers' ),
  		'Listgrouprights'           => 'SpecialListGroupRights',
! 		'Statistics'                => array( 'SpecialPage', 'Statistics' ),
! 		'Randompage'                => 'Randompage',
! 		'Lonelypages'               => array( 'SpecialPage', 'Lonelypages' ),
! 		'Uncategorizedpages'        => array( 'SpecialPage', 'Uncategorizedpages' ),
! 		'Uncategorizedcategories'   => array( 'SpecialPage', 'Uncategorizedcategories' ),
! 		'Uncategorizedimages'       => array( 'SpecialPage', 'Uncategorizedimages' ),
! 		'Uncategorizedtemplates'    => array( 'SpecialPage', 'Uncategorizedtemplates' ),
! 		'Unusedcategories'          => array( 'SpecialPage', 'Unusedcategories' ),
! 		'Unusedimages'              => array( 'SpecialPage', 'Unusedimages' ),
! 		'Wantedpages'               => array( 'IncludableSpecialPage', 'Wantedpages' ),
! 		'Wantedcategories'          => array( 'SpecialPage', 'Wantedcategories' ),
! 		'Mostlinked'                => array( 'SpecialPage', 'Mostlinked' ),
! 		'Mostlinkedcategories'      => array( 'SpecialPage', 'Mostlinkedcategories' ),
! 		'Mostlinkedtemplates'       => array( 'SpecialPage', 'Mostlinkedtemplates' ),
! 		'Mostcategories'            => array( 'SpecialPage', 'Mostcategories' ),
! 		'Mostimages'                => array( 'SpecialPage', 'Mostimages' ),
! 		'Mostrevisions'             => array( 'SpecialPage', 'Mostrevisions' ),
! 		'Fewestrevisions'           => array( 'SpecialPage', 'Fewestrevisions' ),
! 		'Shortpages'                => array( 'SpecialPage', 'Shortpages' ),
! 		'Longpages'                 => array( 'SpecialPage', 'Longpages' ),
! 		'Newpages'                  => 'SpecialNewpages',
! 		'Ancientpages'              => array( 'SpecialPage', 'Ancientpages' ),
! 		'Deadendpages'              => array( 'SpecialPage', 'Deadendpages' ),
! 		'Protectedpages'            => array( 'SpecialPage', 'Protectedpages' ),
! 		'Protectedtitles'           => array( 'SpecialPage', 'Protectedtitles' ),
! 		'Allpages'                  => array( 'IncludableSpecialPage', 'Allpages' ),
! 		'Prefixindex'               => array( 'IncludableSpecialPage', 'Prefixindex' ) ,
! 		'Ipblocklist'               => array( 'SpecialPage', 'Ipblocklist' ),
  		'Specialpages'              => array( 'UnlistedSpecialPage', 'Specialpages' ),
  		'Contributions'             => array( 'SpecialPage', 'Contributions' ),
  		'Emailuser'                 => array( 'UnlistedSpecialPage', 'Emailuser' ),
--- 94,131 ----
  
  		'Recentchanges'             => 'SpecialRecentchanges',
  		'Upload'                    => array( 'SpecialPage', 'Upload' ),
! 		'Imagelist'                 => array( 'SpecialPage', 'Imagelist'),
  		'Newimages'                 => array( 'IncludableSpecialPage', 'Newimages' ),
! 		'Listusers'                 => array( 'SpecialPage', 'Listusers', 'block' ),
  		'Listgrouprights'           => 'SpecialListGroupRights',
! 		'Statistics'                => array( 'SpecialPage', 'Statistics', 'block' ),
! 		'Randompage'                => array( 'SpecialPage', 'Randompage', 'block'),
! 		'Lonelypages'               => array( 'SpecialPage', 'Lonelypages', 'block' ),
! 		'Uncategorizedpages'        => array( 'SpecialPage', 'Uncategorizedpages', 'block' ),
! 		'Uncategorizedcategories'   => array( 'SpecialPage', 'Uncategorizedcategories', 'block' ),
! 		'Uncategorizedimages'       => array( 'SpecialPage', 'Uncategorizedimages', 'block' ),
! 		'Uncategorizedtemplates'    => array( 'SpecialPage', 'Uncategorizedtemplates', 'block' ),
! 		'Unusedcategories'          => array( 'SpecialPage', 'Unusedcategories', 'block' ),
! 		'Unusedimages'              => array( 'SpecialPage', 'Unusedimages', 'block' ),
! 		'Wantedpages'               => array( 'IncludableSpecialPage', 'Wantedpages', 'block' ),
! 		'Wantedcategories'          => array( 'SpecialPage', 'Wantedcategories', 'block' ),
! 		'Mostlinked'                => array( 'SpecialPage', 'Mostlinked', 'block' ),
! 		'Mostlinkedcategories'      => array( 'SpecialPage', 'Mostlinkedcategories', 'block' ),
! 		'Mostlinkedtemplates'       => array( 'SpecialPage', 'Mostlinkedtemplates', 'block' ),
! 		'Mostcategories'            => array( 'SpecialPage', 'Mostcategories', 'block' ),
! 		'Mostimages'                => array( 'SpecialPage', 'Mostimages', 'block' ),
! 		'Mostrevisions'             => array( 'SpecialPage', 'Mostrevisions', 'block' ),
! 		'Fewestrevisions'           => array( 'SpecialPage', 'Fewestrevisions', 'block' ),
! 		'Shortpages'                => array( 'SpecialPage', 'Shortpages', 'block' ),
! 		'Longpages'                 => array( 'SpecialPage', 'Longpages', 'block' ),
! 		'Newpages'                  => array( 'IncludableSpecialPage', 'Newpages', 'block' ),
! 		'Ancientpages'              => array( 'SpecialPage', 'Ancientpages', 'block' ),
! 		'Deadendpages'              => array( 'SpecialPage', 'Deadendpages', 'block' ),
! 		'Protectedpages'            => array( 'SpecialPage', 'Protectedpages', 'block' ),
! 		'Protectedtitles'           => array( 'SpecialPage', 'Protectedtitles', 'block' ),
! 		'Allpages'                  => array( 'IncludableSpecialPage', 'Allpages', 'block' ),
! 		'Prefixindex'               => array( 'IncludableSpecialPage', 'Prefixindex', 'block' ) ,
! 		'Ipblocklist'               => array( 'SpecialPage', 'Ipblocklist', 'block' ),
  		'Specialpages'              => array( 'UnlistedSpecialPage', 'Specialpages' ),
  		'Contributions'             => array( 'SpecialPage', 'Contributions' ),
  		'Emailuser'                 => array( 'UnlistedSpecialPage', 'Emailuser' ),
***************
*** 133,159 ****
  		'Blockme'                   => array( 'UnlistedSpecialPage', 'Blockme' ),
  		'Resetpass'                 => array( 'UnlistedSpecialPage', 'Resetpass' ),
  		'Booksources'               => 'SpecialBookSources',
! 		'Categories'                => array( 'SpecialPage', 'Categories' ),
! 		'Export'                    => array( 'SpecialPage', 'Export' ),
  		'Version'                   => array( 'SpecialPage', 'Version' ),
  		'Blankpage'                 => array( 'UnlistedSpecialPage', 'Blankpage' ),
! 		'Allmessages'               => array( 'SpecialPage', 'Allmessages' ),
! 		'Log'                       => array( 'SpecialPage', 'Log' ),
  		'Blockip'                   => array( 'SpecialPage', 'Blockip', 'block' ),
  		'Undelete'                  => array( 'SpecialPage', 'Undelete', 'deletedhistory' ),
  		'Import'                    => array( 'SpecialPage', 'Import', 'import' ),
  		'Lockdb'                    => array( 'SpecialPage', 'Lockdb', 'siteadmin' ),
  		'Unlockdb'                  => array( 'SpecialPage', 'Unlockdb', 'siteadmin' ),
  		'Userrights'                => 'UserrightsPage',
! 		'MIMEsearch'                => array( 'SpecialPage', 'MIMEsearch' ),
  		'FileDuplicateSearch'       => array( 'SpecialPage', 'FileDuplicateSearch' ),
  		'Unwatchedpages'            => array( 'SpecialPage', 'Unwatchedpages', 'unwatchedpages' ),
! 		'Listredirects'             => array( 'SpecialPage', 'Listredirects' ),
  		'Revisiondelete'            => array( 'UnlistedSpecialPage', 'Revisiondelete', 'deleterevision' ),
! 		'Unusedtemplates'           => array( 'SpecialPage', 'Unusedtemplates' ),
  		'Randomredirect'            => 'SpecialRandomredirect',
! 		'Withoutinterwiki'          => array( 'SpecialPage', 'Withoutinterwiki' ),
! 		'Filepath'                  => array( 'SpecialPage', 'Filepath' ),
  
  		'Mypage'                    => array( 'SpecialMypage' ),
  		'Mytalk'                    => array( 'SpecialMytalk' ),
--- 135,161 ----
  		'Blockme'                   => array( 'UnlistedSpecialPage', 'Blockme' ),
  		'Resetpass'                 => array( 'UnlistedSpecialPage', 'Resetpass' ),
  		'Booksources'               => 'SpecialBookSources',
! 		'Categories'                => array( 'SpecialPage', 'Categories', 'block' ),
! 		'Export'                    => array( 'SpecialPage', 'Export', 'block' ),
  		'Version'                   => array( 'SpecialPage', 'Version' ),
  		'Blankpage'                 => array( 'UnlistedSpecialPage', 'Blankpage' ),
! 		'Allmessages'               => array( 'SpecialPage', 'Allmessages', 'block' ),
! 		'Log'                       => array( 'SpecialPage', 'Log', 'block' ),
  		'Blockip'                   => array( 'SpecialPage', 'Blockip', 'block' ),
  		'Undelete'                  => array( 'SpecialPage', 'Undelete', 'deletedhistory' ),
  		'Import'                    => array( 'SpecialPage', 'Import', 'import' ),
  		'Lockdb'                    => array( 'SpecialPage', 'Lockdb', 'siteadmin' ),
  		'Unlockdb'                  => array( 'SpecialPage', 'Unlockdb', 'siteadmin' ),
  		'Userrights'                => 'UserrightsPage',
! 		'MIMEsearch'                => array( 'SpecialPage', 'MIMEsearch', 'block' ),
  		'FileDuplicateSearch'       => array( 'SpecialPage', 'FileDuplicateSearch' ),
  		'Unwatchedpages'            => array( 'SpecialPage', 'Unwatchedpages', 'unwatchedpages' ),
! 		'Listredirects'             => array( 'SpecialPage', 'Listredirects', 'block' ),
  		'Revisiondelete'            => array( 'UnlistedSpecialPage', 'Revisiondelete', 'deleterevision' ),
! 		'Unusedtemplates'           => array( 'SpecialPage', 'Unusedtemplates', 'block' ),
  		'Randomredirect'            => 'SpecialRandomredirect',
! 		'Withoutinterwiki'          => array( 'SpecialPage', 'Withoutinterwiki', 'block' ),
! 		'Filepath'                  => array( 'SpecialPage', 'Filepath', 'block' ),
  
  		'Mypage'                    => array( 'SpecialMypage' ),
  		'Mytalk'                    => array( 'SpecialMytalk' ),
***************
*** 161,166 ****
  		'Listadmins'                => array( 'SpecialRedirectToSpecial', 'Listadmins', 'Listusers', 'sysop' ),
  		'MergeHistory'              => array( 'SpecialPage', 'MergeHistory', 'mergehistory' ),
  		'Listbots'                  => array( 'SpecialRedirectToSpecial', 'Listbots', 'Listusers', 'bot' ),
  	);
  
  	static public $mAliases;
--- 163,169 ----
  		'Listadmins'                => array( 'SpecialRedirectToSpecial', 'Listadmins', 'Listusers', 'sysop' ),
  		'MergeHistory'              => array( 'SpecialPage', 'MergeHistory', 'mergehistory' ),
  		'Listbots'                  => array( 'SpecialRedirectToSpecial', 'Listbots', 'Listusers', 'bot' ),
+ 		'UserSnoop'                  => array( 'SpecialPage', 'UserSnoop', 'block' ),
  	);
  
  	static public $mAliases;
