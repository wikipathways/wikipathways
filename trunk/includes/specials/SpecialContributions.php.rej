***************
*** 157,163 ****
  		$rev = new Revision( $row );
  
  		$page = Title::makeTitle( $row->page_namespace, $row->page_title );
! 		$link = $sk->makeKnownLinkObj( $page );
  		$difftext = $topmarktext = '';
  		if( $row->rev_id == $row->page_latest ) {
  			$topmarktext .= '<strong>' . $this->messages['uctop'] . '</strong>';
--- 157,170 ----
  		$rev = new Revision( $row );
  
  		$page = Title::makeTitle( $row->page_namespace, $row->page_title );
!                 $name = $page->getText();
! 		if (!$page->isRedirect() && $row->page_namespace == NS_PATHWAY){
! 			$pathway = Pathway::newFromTitle($row->page_title );
! 			$name = $pathway->getSpecies() .":". $pathway->getName();
! 		} elseif ($row->page_namespace == NS_IMAGE ){
! 			return '';
! 		}
! 		$link = $sk->makeKnownLinkObj( $page, $name );
  		$difftext = $topmarktext = '';
  		if( $row->rev_id == $row->page_latest ) {
  			$topmarktext .= '<strong>' . $this->messages['uctop'] . '</strong>';
***************
*** 207,213 ****
  			$mflag = '';
  		}
  
! 		$ret = "{$d} {$histlink} {$difftext} {$nflag}{$mflag} {$link}{$userlink}{$comment} {$topmarktext}";
  		if( $rev->isDeleted( Revision::DELETED_TEXT ) ) {
  			$ret .= ' ' . wfMsgHtml( 'deletedrev' );
  		}
--- 214,221 ----
  			$mflag = '';
  		}
  
! 		//AP20090116 - skip making native history and diff links
! 		$ret = "{$d} {$nflag}{$mflag} {$link}{$userlink}{$comment} {$topmarktext}";
  		if( $rev->isDeleted( Revision::DELETED_TEXT ) ) {
  			$ret .= ' ' . wfMsgHtml( 'deletedrev' );
  		}
***************
*** 317,322 ****
  
  	$wgOut->addHTML( contributionsForm( $options ) );
  
  	$pager = new ContribsPager( $target, $options['namespace'], $options['year'], $options['month'] );
  	if ( !$pager->getNumRows() ) {
  		$wgOut->addWikiMsg( 'nocontribs' );
--- 325,333 ----
  
  	$wgOut->addHTML( contributionsForm( $options ) );
  
+ 	//TK: add new hook that allows us to add content right after the form
+ 	wfRunHooks( 'SpecialContributionsAfterForm', $id);
+ 	
  	$pager = new ContribsPager( $target, $options['namespace'], $options['year'], $options['month'] );
  	if ( !$pager->getNumRows() ) {
  		$wgOut->addWikiMsg( 'nocontribs' );
