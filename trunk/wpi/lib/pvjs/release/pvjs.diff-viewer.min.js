function load(e,t,i){"string"==typeof e&&(i=t,t=e,e=document);var o=e.createElement("script");return o.type="text/javascript",o.src=t,i&&onLoad(o,i),o.onLoad=function(e){return onLoad(o,e)},e.body.appendChild(o),o}function polyfillLoader(e,t,i){if(window[t]=function(){return i(null)},document.body)load(e);else{var o=document.onreadystatechange;document.onreadystatechange=function(){"interactive"===document.readyState&&("function"==typeof o&&o(),load(e))}}}polyfillLoader("//cdn.polyfill.io/v1/polyfill.min.js?features=Array.prototype.indexOf&callback=polyfillServiceCallbackpvjsdiffviewer","polyfillServiceCallbackpvjsdiffviewer",function(){require=function e(t,i,o){function n(a,l){if(!i[a]){if(!t[a]){var d="function"==typeof require&&require;if(!l&&d)return d(a,!0);if(s)return s(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var r=i[a]={exports:{}};t[a][0].call(r.exports,function(e){var i=t[a][1][e];return n(i?i:e)},r,r.exports,e,t,i,o)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({"/Users/andersriutta/Sites/pvjs-lkg/lib/diff-viewer/diff-viewer.js":[function(e){(function(t){var i=(e("fs"),e("insert-css")),o=t("LnB2anMtZGlmZnZpZXdlciB7CiAgICBkaXNwbGF5OiAtbXMtZmxleGJveDsKICAgIGRpc3BsYXk6IC13ZWJraXQtZmxleDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICAtd2Via2l0LWZsZXgtZGlyZWN0aW9uOiByb3c7CiAgICAtbXMtZmxleC1kaXJlY3Rpb246IHJvdzsKICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7CiAgICAtd2Via2l0LWZsZXgtd3JhcDogbm93cmFwOwogICAgLW1zLWZsZXgtd3JhcDogbm93cmFwOwogICAgZmxleC13cmFwOiBub3dyYXA7CiAgICAtd2Via2l0LWp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgLW1zLWZsZXgtcGFjazogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAtd2Via2l0LWFsaWduLWNvbnRlbnQ6IGNlbnRlcjsKICAgIC1tcy1mbGV4LWxpbmUtcGFjazogY2VudGVyOwogICAgYWxpZ24tY29udGVudDogY2VudGVyOwogICAgLXdlYmtpdC1hbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIC1tcy1mbGV4LWFsaWduOiBzdHJldGNoOwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICBtaW4taGVpZ2h0OiA1MDBweDsKICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMDA7CiAgICB9CgoucHZqcy1kaWZmdmlld2VyIC5wYW5lIHsKICBoZWlnaHQ6IGluaGVyaXQ7CiAgd2lkdGg6IGluaGVyaXQ7CiAgLyoKICBmbG9hdDogbGVmdDsKICBvdmVyZmxvdzogaGlkZGVuOwogIHdpZHRoOiA1MCU7CiAgKi8KfQoKLnB2anMtZGlmZnZpZXdlciAucGFuZS1pbm5lciB7CiAgaGVpZ2h0OiBpbmhlcml0OwogIHdpZHRoOiBpbmhlcml0Owp9CgoucHZqcy1kaWZmdmlld2VyIC5wYW5lLnBhbmUtbGVmdCB7CiAgICAtd2Via2l0LW9yZGVyOiAtMTsKICAgIC1tcy1mbGV4LW9yZGVyOiAtMTsKICAgIG9yZGVyOiAtMTsKICAgIC13ZWJraXQtZmxleDogMCAxIGF1dG87CiAgICAtbXMtZmxleDogMCAxIGF1dG87CiAgICBmbGV4OiAxIDEgYXV0bzsKICAgIC13ZWJraXQtYWxpZ24tc2VsZjogYXV0bzsKICAgIC1tcy1mbGV4LWl0ZW0tYWxpZ246IGF1dG87CiAgICBhbGlnbi1zZWxmOiBhdXRvOwogICAgfQoKLnB2anMtZGlmZnZpZXdlciAucGFuZS5wYW5lLWNlbnRlciB7CiAgICAtd2Via2l0LW9yZGVyOiAwOwogICAgLW1zLWZsZXgtb3JkZXI6IDA7CiAgICBvcmRlcjogMDsKICAgIC13ZWJraXQtZmxleDogMCAxIGF1dG87CiAgICAtbXMtZmxleDogMCAxIGF1dG87CiAgICBmbGV4OiAwIDEgYXV0bzsKICAgIC13ZWJraXQtYWxpZ24tc2VsZjogYXV0bzsKICAgIC1tcy1mbGV4LWl0ZW0tYWxpZ246IGF1dG87CiAgICBhbGlnbi1zZWxmOiBhdXRvOwogICAgfQoKLnB2anMtZGlmZnZpZXdlciAucGFuZS5wYW5lLXJpZ2h0IHsKICAgIC13ZWJraXQtb3JkZXI6IDE7CiAgICAtbXMtZmxleC1vcmRlcjogMTsKICAgIG9yZGVyOiAxOwogICAgLXdlYmtpdC1mbGV4OiAwIDEgYXV0bzsKICAgIC1tcy1mbGV4OiAwIDEgYXV0bzsKICAgIGZsZXg6IDEgMSBhdXRvOwogICAgLXdlYmtpdC1hbGlnbi1zZWxmOiBhdXRvOwogICAgLW1zLWZsZXgtaXRlbS1hbGlnbjogYXV0bzsKICAgIGFsaWduLXNlbGY6IGF1dG87CiAgICB9CgouZGlhZ3JhbS1jb250YWluZXIgewogIC8qIGEga2x1ZGdlIHRvIGFkZHJlc3MgdGhlIHByb2JsZW0gd2hlcmUgdGhlIGhlaWdodCBpcyB0b28gc21hbGwgKi8KICBtaW4taGVpZ2h0OiA1MDBweDsKICB9CgovKioqKioqKioqKioqKioKICBPdmVybGF5CiAqKioqKioqKioqKioqKi8KCi5wdmpzLWRpZmZ2aWV3ZXIgPiAub3ZlcmxheSB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMDsKICBsZWZ0OiAwOwogIGJvdHRvbTogMDsKICByaWdodDogMDsKICBiYWNrZ3JvdW5kOiAjZmZmOwp9CgoucHZqcy1kaWZmdmlld2VyID4gLm92ZXJsYXkgLmFsZXJ0ewogIHBhZGRpbmc6IDlweCAxNXB4OwogIG1hcmdpbjogNHB4OwogIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50OwogIGJvcmRlci1yYWRpdXM6IDRweDsKfQoKLnB2anMtZGlmZnZpZXdlciA+IC5vdmVybGF5IC5hbGVydC5hbGVydC1zdWNjZXNzewogIGJhY2tncm91bmQtY29sb3I6ICNkZmYwZDg7CiAgYm9yZGVyLWNvbG9yOiAjZDZlOWM2OwogIGNvbG9yOiAjM2M3NjNkOwp9CgoucHZqcy1kaWZmdmlld2VyID4gLm92ZXJsYXkgLmFsZXJ0LmFsZXJ0LWluZm97CiAgYmFja2dyb3VuZC1jb2xvcjogI2Q5ZWRmNzsKICBib3JkZXItY29sb3I6ICNiY2U4ZjE7CiAgY29sb3I6ICMzMTcwOGY7Cn0KCi5wdmpzLWRpZmZ2aWV3ZXIgPiAub3ZlcmxheSAuYWxlcnQuYWxlcnQtd2FybmluZ3sKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmNmOGUzOwogIGJvcmRlci1jb2xvcjogI2ZhZWJjYzsKICBjb2xvcjogIzhhNmQzYjsKfQoKLnB2anMtZGlmZnZpZXdlciA+IC5vdmVybGF5IC5hbGVydC5hbGVydC1kYW5nZXJ7CiAgYmFja2dyb3VuZC1jb2xvcjogI2YyZGVkZTsKICBib3JkZXItY29sb3I6ICNlYmNjZDE7CiAgY29sb3I6ICNhOTQ0NDI7Cn0KCi8qKioqKioqKioqKioqKgogIENoYW5nZXMgTWFpbgogKioqKioqKioqKioqKiovCgouY2hhbmdlcyB7CiAgbWFyZ2luOiAwIDEycHg7CiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICMwMDA7CgogIGZvbnQtZmFtaWx5OiBBcmlhbCwgIkhlbHZldGljYSBOZXVlIiwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmOwogIGZvbnQtc2l6ZTogMTNweDsKfQoKLmNoYW5nZXMtY29udGFpbmVyIHsKfQoKLyoqKioqKioqKioqKioqCiAgQ2hhbmdlcyBUaXRsZXMKICoqKioqKioqKioqKioqLwoKLmNoYW5nZXMtdGl0bGUgewogIHBhZGRpbmc6IDVweCA0cHggM3B4OwogIGJvcmRlcjogMXB4IHNvbGlkICMwMDA7CiAgYm9yZGVyLWJvdHRvbTogMHB4OwoKICBmb250LXNpemU6IDE2cHg7Cn0KCi5jaGFuZ2VzLXRpdGxlIGl7CiAgZm9udC1zaXplOiA5MCU7CiAgb3BhY2l0eTogMC44OwogIGZvbnQtc3R5bGU6IG5vcm1hbDsKfQoKLmNoYW5nZXMtdGl0bGUgaS5pY29uewogIGZvbnQtc2l6ZTogOTAlOwogIG9wYWNpdHk6IDAuODsKICBmb250LXN0eWxlOiBub3JtYWw7CiAgZm9udC13ZWlnaHQ6IG5vcm1hbDsKfQoKLmNoYW5nZXMtcGFyZW50IHNwYW4gewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgcGFkZGluZzogMCAwIDAgMTNweDsKfQoKLmNoYW5nZXMtcGFyZW50IHNwYW46YmVmb3JlIHsKICBjb250ZW50OiAnJzsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiA1MCU7CiAgbGVmdDogM3B4OwogIHdpZHRoOiAwOwogIGhlaWdodDogMDsKICBtYXJnaW46IC02cHggMCAwOwogIGJvcmRlci13aWR0aDogNXB4IDAgNXB4IDZweDsKICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50ICMwMDA7CiAgYm9yZGVyLXN0eWxlOiBzb2xpZDsKfQoKLm9wZW4gPiAuY2hhbmdlcy1wYXJlbnQgc3BhbjpiZWZvcmUgewogIGxlZnQ6IDA7CiAgbWFyZ2luLXRvcDogLTRweDsKICBib3JkZXItd2lkdGg6IDZweCA1cHggMCA1cHg7CiAgYm9yZGVyLWNvbG9yOiAjMDAwIHRyYW5zcGFyZW50IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50Owp9CgovKiBOZXN0aW5nICovCi5jaGFuZ2VzLWNvbnRhaW5lciAuY2hhbmdlcy1jb250YWluZXIgLmNoYW5nZXMtdGl0bGUgewogIGZvbnQtc2l6ZTogMTRweDsKfQouY2hhbmdlcy1jb250YWluZXIgLmNoYW5nZXMtY29udGFpbmVyIC5jaGFuZ2VzLWNvbnRhaW5lciAuY2hhbmdlcy10aXRsZSB7CiAgcGFkZGluZy1sZWZ0OiAxMHB4OwogIGZvbnQtc2l6ZTogMTJweDsKfQoKLmNoYW5nZXMtY29udGFpbmVyLmFjdGl2ZSA+IC5jaGFuZ2VzLXRpdGxlIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7Cn0KLmNoYW5nZXMtY29udGFpbmVyLmFjdGl2ZSA+IC5jaGFuZ2VzLXRpdGxlOmJlZm9yZSwKLmNoYW5nZXMtY29udGFpbmVyLmFjdGl2ZSA+IC5jaGFuZ2VzLXRpdGxlOmFmdGVyIHsKICBjb250ZW50OiAnJzsKICBkaXNwbGF5OiBub25lOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDUwJTsKICBtYXJnaW46IC0xMnB4IDAgMDsKICB3aWR0aDogMDsKICBoZWlnaHQ6IDA7CiAgYm9yZGVyLXRvcDogMTJweCBzb2xpZCB0cmFuc3BhcmVudDsKICBib3JkZXItYm90dG9tOiAxMnB4IHNvbGlkIHRyYW5zcGFyZW50Owp9CgouY2hhbmdlcy1jb250YWluZXIuYWN0aXZlLmZvY3VzID4gLmNoYW5nZXMtdGl0bGV7CiAgLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDAgMTBweCAwcHggcmdiYSgwLCAwLCAwLCAwLjM1KTsKICAgICAtbW96LWJveC1zaGFkb3c6IGluc2V0IDAgMCAxMHB4IDBweCByZ2JhKDAsIDAsIDAsIDAuMzUpOwogICAgICAgICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDEwcHggMHB4IHJnYmEoMCwgMCwgMCwgMC4zNSk7Cn0KCi5jaGFuZ2VzLWNvbnRhaW5lci5hY3RpdmUgPiAuY2hhbmdlcy10aXRsZTpiZWZvcmUgewogIGxlZnQ6IC0xMnB4OwogIGJvcmRlci1yaWdodDogMTJweCBzb2xpZCAjMDAwOwp9CgouY2hhbmdlcy1jb250YWluZXIuYWN0aXZlID4gLmNoYW5nZXMtdGl0bGU6YWZ0ZXIgewogIHJpZ2h0OiAtMTJweDsKICBib3JkZXItbGVmdDogMTJweCBzb2xpZCAjMDAwOwp9CgouY2hhbmdlcy10aXRsZS5jaGFuZ2UtYWRkZWQgewogIGJhY2tncm91bmQ6ICNhNmMwZTE7Cn0KLmNoYW5nZXMtY29udGFpbmVyLmFjdGl2ZSA+IC5jaGFuZ2VzLXRpdGxlLmNoYW5nZS1hZGRlZCB7CiAgYmFja2dyb3VuZDogIzZjOTFjYzsKfQouY2hhbmdlcy1jb250YWluZXIuYWN0aXZlID4gLmNoYW5nZXMtdGl0bGUuY2hhbmdlLWFkZGVkOmFmdGVyIHsKICBkaXNwbGF5OiBibG9jazsKfQoKLmNoYW5nZXMtdGl0bGUuY2hhbmdlLXVwZGF0ZWQgewogIGJhY2tncm91bmQ6ICNmZWZjOTY7Cn0KLmNoYW5nZXMtY29udGFpbmVyLmFjdGl2ZSA+IC5jaGFuZ2VzLXRpdGxlLmNoYW5nZS11cGRhdGVkIHsKICBiYWNrZ3JvdW5kOiAjZmZmOTQ0Owp9Ci5jaGFuZ2VzLWNvbnRhaW5lci5hY3RpdmUgPiAuY2hhbmdlcy10aXRsZS5jaGFuZ2UtdXBkYXRlZDpiZWZvcmUsCi5jaGFuZ2VzLWNvbnRhaW5lci5hY3RpdmUgPiAuY2hhbmdlcy10aXRsZS5jaGFuZ2UtdXBkYXRlZDphZnRlciB7CiAgZGlzcGxheTogYmxvY2s7Cn0KCi5jaGFuZ2VzLXRpdGxlLmNoYW5nZS1yZW1vdmVkIHsKICBiYWNrZ3JvdW5kOiAjZjlhNGFmOwp9Ci5jaGFuZ2VzLWNvbnRhaW5lci5hY3RpdmUgPiAuY2hhbmdlcy10aXRsZS5jaGFuZ2UtcmVtb3ZlZCB7CiAgYmFja2dyb3VuZDogI2YzNmI3ODsKfQouY2hhbmdlcy1jb250YWluZXIuYWN0aXZlID4gLmNoYW5nZXMtdGl0bGUuY2hhbmdlLXJlbW92ZWQ6YmVmb3JlIHsKICBkaXNwbGF5OiBibG9jazsKfQoKLmNoYW5nZXMtdGl0bGUuYWN0aXZlIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7Cn0KLmNoYW5nZXMtdGl0bGUuYWN0aXZlOmJlZm9yZSB7CiAgY29udGVudDogJyc7CiAgcG9zaXRpb246IGFic29sdXRlOwp9CgoKLyoqKioqKioqKioqKioqCiAgQ2hhbmdlcyBMaXN0CiAqKioqKioqKioqKioqKi8KLmNoYW5nZXMtbGlzdCB7CiAgZGlzcGxheTogbm9uZTsKfQoKLmNoYW5nZXMuY2hhbmdlcy1saXN0IHsKICBkaXNwbGF5OiBibG9jazsKfQoKLmNoYW5nZXMtY29udGFpbmVyLm9wZW4gPiAuY2hhbmdlcy1saXN0IHsKICBkaXNwbGF5OiBibG9jazsKfQoKLyoqKioqKioqKioqKioqCiAgQ2hhbmdlcyBMaXN0CiAqKioqKioqKioqKioqKi8KLyouY2hhbmdlcy10aXRsZS5hY3RpdmUqLwouY2hhbmdlcy10aXRsZSA+IC5lbGVtZW50LWNoYW5nZXMgewogIGRpc3BsYXk6IG5vbmU7Cn0KCi5hY3RpdmUgPiAuY2hhbmdlcy10aXRsZSA+IC5lbGVtZW50LWNoYW5nZXMgewogIGRpc3BsYXk6IGJsb2NrOwogIG1hcmdpbjogMDsKICBwYWRkaW5nOiA0cHggMCA0cHg7CiAgbGluZS1oZWlnaHQ6IDEuNDsKICBsaXN0LXN0eWxlOiBub25lOwogIHdvcmQtd3JhcDogYnJlYWstd29yZDsKfQo=","base64");!function(e,t){function n(e,t){var i={added:[],removed:[],updated:[]};for(var o in e)t.hasOwnProperty(o)?e[o]!==t[o]&&s(e[o])&&s(t[o])&&i.updated.push({key:o,value:t[o],old:e[o]}):i.removed.push({key:o,value:e[o]});for(var n in t)e.hasOwnProperty(n)||i.added.push({key:n,value:t[n]});return i.added.length||i.removed.length||i.updated.length?i:null}function s(e){return Object.prototype.toString.apply(1)===Object.prototype.toString.apply(e)||Object.prototype.toString.apply("")===Object.prototype.toString.apply(e)}function a(e){var t="",i=[];for(var o in m)t=m[o],e.hasOwnProperty(t)&&(i.push({group:e[t],name:t}),delete e[t]);for(t in e)i.push({group:e[t],name:t});return i}function l(e,t){return e["gpml:element"]===t["gpml:element"]?e.shape>t.shape?1:-1:void 0===e["gpml:element"]?-1:void 0===t["gpml:element"]?1:e["gpml:element"]>t["gpml:element"]?1:-1}function d(e,t){return"gpml:Interaction"===e["gpml:element"]?""+p(e.points[0].isAttachedTo,t)+' <i class="icon icon-arrow-right"></i> '+p(e.points[1].isAttachedTo,t):"gpml:DataNode"===e["gpml:element"]?e.textContent:"gpml:Label"===e["gpml:element"]?e.textContent:"gpml:Shape"===e["gpml:element"]?e.shape.slice(0,1).toUpperCase()+e.shape.slice(1):"gpml:GraphicalLine"===e["gpml:element"]?"Graphical line":"gpml:State"===e["gpml:element"]?"State "+e.textContent+" ("+p(e.isAttachedTo,t)+")":"gpml:Group"===e["gpml:element"]?"Group":void 0!==e.type?e.textContent||e.title||e.displayName||"no title":"no title"}function p(e,t){if(void 0===e)return"Unknown";for(var i in t)if(null!==t[i].id&&e===t[i].id)return"gpml:Interaction"===t[i]["gpml:element"]?"Interaction":d(t[i],t);return e}function r(e,t,i){return-1!==u.indexOf(t)?Math.round(100*parseFloat(e))/100:-1!==v.indexOf(t)?p(e,i):e}function g(e){return e.length?e.parent().data("type"):null}i(o);var c={sourceData:[]},h=function(i,o){this.$pvjsElement=t(i),this.initContainer(),this.pvjsOptions=t.extend({},c,o[0]),this.pvjs=new e.Pvjs(this.$paneLeft[0],this.pvjsOptions).getPublicInstance(),this.pvjsOptions2=t.extend({},c,o[1]),this.pvjs2=new e.Pvjs(this.$paneRight[0],this.pvjsOptions2).getPublicInstance(),this.hookEvents(),this.pvjs.render(),this.pvjs2.render()};h.prototype.initContainer=function(){this.$diffviewer=t('<div class="pvjs-diffviewer"/>'),this.$paneLeft=t('<div class="pane pane-left"></div>').appendTo(this.$diffviewer),this.$paneRight=t('<div class="pane pane-right"></div>').appendTo(this.$diffviewer),this.$paneCenter=t('<div class="pane pane-center"></div>').appendTo(this.$diffviewer),this.$diffviewer.insertBefore(this.$pvjsElement),this.$paneLeft.append(this.$pvjsElement)},h.prototype.initSecondPvjs=function(){this.$pvjsElement2=t("<div/>").appendTo(this.$paneRight);var e=this.pvjs.getOptions();e.sourceData=this.pvjsOptions.sourceData,e.manualRender=!0,this.$pvjsElement2.pvjs(e),this.pvjs2=this.$pvjsElement2.pvjs("get").pop()},h.prototype.hookEvents=function(){var t=this,i=!1,o=!1,n=!1;this.pvjs.on("rendered",function(){i=!0,o&&!n&&t.onPvjsesRendered()}),this.pvjs2.on("rendered",function(){o=!0,i&&!n&&t.onPvjsesRendered()}),this.pvjs.on("error.sourceData",function(){n||t.onNoDiff("One or both pathways were not rendered. Most probably one pathways uses old format that is not supported by pvjs."),n=!0}),this.pvjs2.on("error.sourceData",function(){n||t.onNoDiff("One or both pathways were not rendered.Most probably one pathways uses old format that is not supported by pvjs."),n=!0}),this.pvjs.on("destroy.pvjs",function(){t.pvjs2.destroy(),t.$pvjsElement.insertBefore(t.$diffviewer),t.$diffviewer.remove()});var s=!1,a=!1,l=!1,d=!1;this.pvjs.on("zoomed.renderer",function(i){return d?void e.setTimeout(function(){d=!1},0):(a=!0,t.pvjs2.zoom(i/t.zoomScale),t.pvjs.panBy({x:0,y:0}),void t.pvjs2.pan(t.pvjs.getPan()))}),this.pvjs.on("panned.renderer",function(i){return l?void e.setTimeout(function(){l=!1},0):(s=!0,void t.pvjs2.pan(i))}),this.pvjs2.on("zoomed.renderer",function(i){return a?void e.setTimeout(function(){a=!1},0):(d=!0,t.pvjs.zoom(i*t.zoomScale),t.pvjs2.panBy({x:0,y:0}),void t.pvjs.pan(t.pvjs2.getPan()))}),this.pvjs2.on("panned.renderer",function(i){return s?void e.setTimeout(function(){s=!1},0):(l=!0,void t.pvjs.pan(i))})},h.prototype.onNoDiff=function(e){void 0===this.$overlay&&(this.$overlay=t('<div class="overlay"></div>').appendTo(this.$diffviewer)),this.$overlay.append(t('<div class="alert alert-info"></div>').text(e))},h.prototype.onPvjsesRendered=function(){this.checkPvjsesData()?(this.getZoomScale(),this.displayDiff()):this.onNoDiff("One or both pathways were rendered using a format (ex. png) that has no details about nodes.")},h.prototype.checkPvjsesData=function(){return this.pvjs.getSourceData().pvjson&&this.pvjs2.getSourceData().pvjson},h.prototype.zoomScale=1,h.prototype.getZoomScale=function(){this.zoomScale=this.pvjs.getZoom()/this.pvjs2.getZoom()},h.prototype.displayDiff=function(){this.elements=this.pvjs.getSourceData().pvjson.elements,this.elements2=this.pvjs2.getSourceData().pvjson.elements,this.elementsMerge=this.mergeElements(this.elements2,this.elements);var e=this.computeDiff();if(e.added.length+e.updated.length+e.removed.length===0)return void this.onNoDiff("Pathways have no visual differences between them.");var t=this.initDiffView();this.elementsCache={added:{},updated:{},removed:{}},this.elementsReferences={},this.renderDiffsOfType("added",e.added,t,this.elements2),this.renderDiffsOfType("updated",e.updated,t,this.elementsMerge),this.renderDiffsOfType("removed",e.removed,t,this.elements),this.hookDiffNavigation(),this.highlightType("added"),this.highlightType("updated"),this.highlightType("removed")},h.prototype.mergeElements=function(e,t){var i=e.slice(),o=!1;for(var n in t){o=!1;for(var s in i)if(i[s].id===t[n].id){o=!0;break}o||i.push(t[n])}return i},h.prototype.computeDiff=function(){for(var e,t,i=this.elements.slice(),o=this.elements2.slice(),s={updated:[],added:[],removed:[]},a=i.length-1;a>=0;a--){e=i[a],t=!1;for(var l=o.length-1;l>=0;l--)if(i[a].id===o[l].id){t=!0,n(i[a],o[l])&&s.updated.push({id:o[l].id,"gpml:element":o[l]["gpml:element"]||i[a]["gpml:element"]||void 0,type:o[l].type||i[a].type||void 0,shape:o[l].shape||i[a].shape||void 0,textContent:o[l].textContent||i[a].textContent||o[l].title||o[l].displayName||i[a].title||i[a].displayName||void 0,points:o[l].points||i[a].points||void 0,diff:n(i[a],o[l]),_element:i[a],_element2:o[l]}),i.splice(a,1),o.splice(l,1);break}t||s.removed.push(i[a])}return s.added=o.slice(),s},h.prototype.initDiffView=function(){return t('<div class="changes changes-list"></div>').appendTo(this.$paneCenter)},h.prototype.initDiffViewList=function(e,i,o){var n=t('<div class="changes-container" data-level="1" data-type="'+i+'">').appendTo(e).append(t('<div class="changes-title changes-parent change-'+i+'"><span>'+o+"</span></div>"));return t('<div class="changes-list"></div>').appendTo(n)},h.prototype.renderDiffsOfType=function(e,i,o,n){if(0!==i.length){var s=i.sort(l),d={},p="",r="",g="",c=null,h=[];for(var m in s){if(r=s[m]["gpml:element"]?s[m]["gpml:element"].replace(/^gpml\:/,""):"",g=s[m].type?s[m].type:"","Interaction"===r)p="Interactions";else if("DataNode"===r)p="Data Nodes";else{if(""===r&&""!==g)continue;p="Group"===r?"Groups":"Graphical Objects"}void 0===d[p]&&(d[p]=[]),d[p].push(s[m])}if(!t.isEmptyObject(d)){c=this.initDiffViewList(o,e,e.charAt(0).toUpperCase()+e.slice(1)),h=a(d);for(var u in h)this.renderDiffGroup(e,h[u].name,h[u].group,c,n)}}};var m=["Data Nodes","Groups","Interactions","Graphical Objects"];h.prototype.renderDiffGroup=function(e,i,o,n,s){var a,l,p,r=t('<div class="changes-container" data-level="2" data-type="'+e+'"/>').appendTo(n),g=(t('<div class="changes-title changes-parent change-'+e+'"><span>'+i+"</span></div>").appendTo(r).data("group",i),t('<div class="changes-list" />').appendTo(r)),c="",h=null;o=o.sort(function(e,t){return d(e,s).toLowerCase()>d(t,s).toLowerCase()?1:-1});for(var m in o){if(c=d(o[m],s),a=t('<div class="changes-container" data-level="3" data-type="'+e+'"/>').appendTo(g),l=t('<div class="changes-title change-'+e+'"><span>'+c+"</span></div>").appendTo(a),h=this.getElementChanges(e,o[m],s),h&&h.length){p=t('<ul class="element-changes"></ul>');for(var u in h)p.append("<li>"+h[u]+"</li>");p.appendTo(l)}l.data("id",o[m].id).data("group",i),l[0].pvjson=o[m],this.cacheElement(e,i,o[m].id)}},h.prototype.cacheElement=function(e,t,i){void 0===this.elementsCache[e][t]&&(this.elementsCache[e][t]=[]),this.elementsCache[e][t].push(i),"Reference"===t&&(this.elementsReferences[i]=!0)},h.prototype.getAllElementsIds=function(e,t){if(null===e||void 0===e)return[].concat(this.getAllElementsIds("added"),this.getAllElementsIds("updated"),this.getAllElementsIds("removed"));if(null===t||void 0===t){var i=[];for(var o in this.elementsCache[e])i=i.concat(this.getAllElementsIds(e,o));return i}return this.elementsCache[e][t].slice()},h.prototype.isIdReference=function(e){return this.elementsReferences[e]===!0};var u=["width","height","x","y","rotation"],v=["isPartOf","controller","controlled"];h.prototype.getElementChanges=function(e,t,i){var o=[];if("added"===e)t.hasOwnProperty("entityReference")&&o.push("Added <strong>reference</strong>: "+t.entityReference);else if("updated"===e){var n="",s="",a=t.diff;for(var l in a.added)s=r(a.added[l].value,a.added[l].key,i),o.push("Added: <strong>"+a.added[l].key+"</strong> "+s);for(var d in a.removed)s=r(a.removed[d].value,a.removed[d].key,i),o.push("Removed: <strong>"+a.removed[d].key+"</strong> "+s);for(var p in a.updated)n=r(a.updated[p].old,a.updated[p].key,i),s=r(a.updated[p].value,a.updated[p].key,i),o.push("<strong>"+a.updated[p].key+":</strong> "+n+' <i class="icon icon-arrow-right"></i> '+s)}return o},h.prototype.hookDiffNavigation=function(){var e=this.$paneCenter,i=this,o=!1,n=this.pvjs.getZoom(),s=this.pvjs2.getZoom();e.on("click",".changes-title",function(n){n.preventDefault(),n.stopPropagation(),o=!0;var s=t(this),a=s;s.parent().hasClass("active")||(e.find(".active").removeClass("active"),e.find(".open").removeClass("open"),e.find(".focus").removeClass("focus"),s.parent().addClass("active focus"),s.parentsUntil(e).addClass("open"),i.attenuate(),i.highlightIds(i.getTitleIds(a),g(a)))}).on("dblclick",".changes-title",function(e){e.preventDefault(),e.stopPropagation(),i.zoomToTitle(t(this),n,s)});var a={37:"left",38:"up",39:"right",40:"down"};t(document).click(function(){o=!1,e.find(".focus").removeClass("focus")}).keydown(function(e){return o&&!(e.keyCode<37||e.keyCode>40)?(e.preventDefault(),e.stopPropagation(),i.navigate(a[e.keyCode]),!1):void 0})},h.prototype.getTitleIds=function(e){var t=[];if(e.length){var i=+e.parent().data("level"),o=g(e),n=null,s=null;1===i||(2===i?n=e.data("group"):3===i&&(n=e.data("group"),s=e.data("id"))),t=this.getIds(o,n,s)}return t},h.prototype.getIds=function(e,t,i){var o=[];return o=e&&t&&i?[i]:this.getAllElementsIds(e,t)},h.prototype.highlightIds=function(e,t){var i={};"added"===t?i.backgroundColor=i.borderColor="#0E53A7":"updated"===t?i.backgroundColor=i.borderColor="#FFF700":"removed"===t&&(i.backgroundColor=i.borderColor="#F10026");for(var o in e){var n;n=this.isIdReference(e[o])?"xref:id:"+e[o]:"#"+e[o],("removed"===t||"updated"===t)&&this.pvjs.highlight(n,null,i),("updated"===t||"added"===t)&&this.pvjs2.highlight(n,null,i)}},h.prototype.highlightType=function(e){this.highlightIds(this.getIds(e),e)},h.prototype.highlightTitle=function(e){this.highlightIds(this.getTitleIds(e),g(e))},h.prototype.zoomToTitle=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=1);var o=g(e),n="added"===o?i:t,s=n,a="added"===o?this.pvjs2:this.pvjs,l=a.getSourceData().selector,d=l.getBBox(),p=this.getTitleIds(e),r=l.filteredByCallback(function(e){return void 0!==e.id&&-1!==p.indexOf(e.id)}),c=r.getBBox();if("updated"===o){r=this.pvjs2.getSourceData().selector.filteredByCallback(function(e){return void 0!==e.id&&-1!==p.indexOf(e.id)});var h=r.getBBox();c.left=Math.min(c.left,h.left),c.top=Math.min(c.top,h.top),c.right=Math.max(c.right,h.right),c.bottom=Math.max(c.bottom,h.bottom),c.width=Math.abs(c.right-c.left),c.height=Math.abs(c.bottom-c.top)}s=n/(Math.max(c.width/d.width,c.height/d.height)||1),s*=.7,a.zoom(s);var m=a.getZoom(),u=-c.left*m+c.width*m*.15,v=-c.top*m+c.height*m*.15;a.pan({x:u,y:v})},h.prototype.navigate=function(e){var t=this.$paneCenter,i=t.find(".focus").first(),o=null,n=null;"up"===e||"left"===e?(o=i.prev(),0===o.length&&(o=i.parent().closest(".changes-container"))):("down"===e||"right"===e)&&(o=i.children(".changes-list").children(".changes-container").first(),0===o.length&&(o=i.next(),0===o.length&&(o=i.parent().closest(".changes-container").next(),0===o.length&&(o=i.parent().closest(".changes-container").parent().closest(".changes-container").next())))),o&&o.length&&o.get(0)!==i.get(0)&&(t.find(".active").removeClass("active"),t.find(".open").removeClass("open"),t.find(".focus").removeClass("focus"),o.addClass("active focus open"),o.parentsUntil(t).addClass("open"),n=o.children(".changes-title"),n.offset().top<0?t.scrollTop(t.scrollTop()+n.offset().top):n.offset().top+n.outerHeight()>t.height()&&t.scrollTop(t.scrollTop()+(n.offset().top+n.outerHeight()-t.height())),this.attenuate(),this.highlightTitle(o.children(".changes-title")))},h.prototype.initHighlighting=function(){this.hi=e.pvjsHighlighter(this.pvjs,{displayInputField:!1}),this.hi2=e.pvjsHighlighter(this.pvjs2,{displayInputField:!1})},h.prototype.attenuate=function(){this.pvjs.attenuate(null),this.pvjs2.attenuate(null)},e.PvjsDiffViewer=h}(window,window.jQuery||window.Zepto)}).call(this,e("buffer").Buffer)},{buffer:"/Users/andersriutta/Sites/pvjs-lkg/node_modules/buffer/index.js",fs:"/Users/andersriutta/Sites/pvjs-lkg/node_modules/browserify/lib/_empty.js","insert-css":"/Users/andersriutta/Sites/pvjs-lkg/node_modules/insert-css/index.js"}]},{},["/Users/andersriutta/Sites/pvjs-lkg/lib/diff-viewer/diff-viewer.js"])});
//# sourceMappingURL=pvjs.diff-viewer.min.js.map